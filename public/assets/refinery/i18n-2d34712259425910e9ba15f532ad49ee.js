// Instantiate the object
var I18n=I18n||{};I18n.defaultLocale="en",I18n.locale=I18n.locale||null,I18n.lookup=function(a,b){var c=this.prepareOptions(I18n.translations),d=c[I18n.currentLocale()];b=this.prepareOptions(b);if(!d)return;typeof a=="object"&&(a=a.join(".")),b.scope&&(a=b.scope.toString()+"."+a),a=a.split(".");while(a.length>0){var e=a.shift();d=d[e];if(!d)break}return!d&&b.defaultValue!=null&&b.defaultValue!=undefined&&(d=b.defaultValue),d},I18n.prepareOptions=function(){var a={},b,c=arguments.length;for(var d=0;d<c;d++){b=arguments[d];if(!b)continue;for(var e in b)if(a[e]==undefined||a[e]==null)a[e]=b[e]}return a},I18n.interpolate=function(a,b){b=b||{};var c=/\{\{(.*?)\}\}/gm,d=a.match(c);if(!d)return a;var e,f,g;for(var h=0;e=d[h];h++){g=e.replace(/\{\{(.*?)\}\}/gm,"$1"),f=b[g];if(b[g]==null||b[g]==undefined)f="[missing "+e+" value]";c=new RegExp(e.replace(/\{/gm,"\\{").replace(/\}/gm,"\\}")),a=a.replace(c,f)}return a},I18n.translate=function(a,b){b=this.prepareOptions(b);var c=this.lookup(a,b);try{return typeof c=="object"?typeof b.count=="number"?this.pluralize(b.count,a,b):c:this.interpolate(c,b)}catch(d){return this.missingTranslation(a)}},I18n.localize=function(a,b){switch(a){case"currency":return this.toCurrency(b);case"number":return a=this.lookup("number.format"),this.toNumber(b,a);default:return a.match(/^(date|time)/)?this.toTime(a,b):b.toString()}},I18n.parseDate=function(a){var b,c,d,e,f,g,h,i=null;if(b=a.toString().match(/(\d{4})-(\d{2})-(\d{2})(?:[ |T](\d{2}):(\d{2}):(\d{2}))?(Z)?/)){for(var j=1;j<=6;j++)b[j]=b[j]==undefined?0:parseInt(b[j],10);b[2]=b[2]-1,b[7]?c=new Date(Date.UTC(b[1],b[2],b[3],b[4],b[5],b[6])):isNaN(b[4])?c=new Date(b[1],b[2],b[3]):c=new Date(b[1],b[2],b[3],b[4],b[5],b[6])}else typeof a=="number"?(c=new Date,c.setTime(a)):(c=new Date,c.setTime(Date.parse(a)));return c},I18n.toTime=function(a,b){var c=this.parseDate(b),d=this.lookup(a);return c.toString().match(/invalid/i)?c.toString():d?this.strftime(c,d):c.toString()},I18n.strftime=function(a,b){var c=this.lookup("date");if(!c)return a.toString();var d=a.getDay(),e=a.getDate(),f=a.getFullYear(),g=a.getMonth()+1,h=a.getHours(),i=h,j=h>12?"PM":"AM",k=a.getSeconds(),l=a.getMinutes(),m=a.getTimezoneOffset(),n=Math.floor(Math.abs(m/60)),o=Math.abs(m)-n*60,p=(m>0?"-":"+")+(n.toString().length<2?"0"+n:n)+(o.toString().length<2?"0"+o:o);i>12&&(i-=12);var q=function(a){var b="0"+a.toString();return b.substr(b.length-2)},r=b;return r=r.replace("%a",c.abbr_day_names[d]),r=r.replace("%A",c.day_names[d]),r=r.replace("%b",c.abbr_month_names[g]),r=r.replace("%B",c.month_names[g]),r=r.replace("%d",q(e)),r=r.replace("%-d",e),r=r.replace("%H",q(h)),r=r.replace("%-H",h),r=r.replace("%I",q(i)),r=r.replace("%-I",i),r=r.replace("%m",q(g)),r=r.replace("%-m",g),r=r.replace("%M",q(l)),r=r.replace("%-M",l),r=r.replace("%p",j),r=r.replace("%S",q(k)),r=r.replace("%-S",k),r=r.replace("%w",d),r=r.replace("%y",q(f)),r=r.replace("%-y",q(f).replace(/^0+/,"")),r=r.replace("%Y",f),r=r.replace("%z",p),r},I18n.toNumber=function(a,b){b=this.prepareOptions(b,this.lookup("number.format"),{precision:3,separator:".",delimiter:","});var c=a.toFixed(b.precision).toString(),d=c.split(".");a=d[0];var e=d[1],f=[];while(a.length>0)f.unshift(a.substr(Math.max(0,a.length-3),3)),a=a.substr(0,a.length-3);var g=f.join(b.delimiter);return b.precision>0&&(g+=b.separator+d[1]),g},I18n.toCurrency=function(a,b){return b=this.prepareOptions(b,this.lookup("number.currency.format"),this.lookup("number.format"),{unit:"$",precision:2,format:"%u%n",delimiter:",",separator:"."}),a=this.toNumber(a,b),a=b.format.replace("%u",b.unit).replace("%n",a),a},I18n.toPercentage=function(a,b){return b=this.prepareOptions(b,this.lookup("number.percentage.format"),this.lookup("number.format"),{precision:3,separator:".",delimiter:""}),a=this.toNumber(a,b),a+"%"},I18n.pluralize=function(a,b,c){var d=this.lookup(b,c),e;c=c||{},c.count=a.toString();switch(Math.abs(a)){case 0:e=d.zero||d.none||d.other||this.missingTranslation(b,"zero");break;case 1:e=d.one||this.missingTranslation(b,"one");break;default:e=d.other||this.missingTranslation(b,"other")}return this.interpolate(e,c)},I18n.missingTranslation=function(){var a='[missing "'+this.currentLocale(),b=arguments.length;for(var c=0;c<b;c++)a+="."+arguments[c];return a+='" translation]',a},I18n.currentLocale=function(){return I18n.locale||I18n.defaultLocale},I18n.t=I18n.translate,I18n.l=I18n.localize,I18n.p=I18n.pluralize,I18n.locale="en"